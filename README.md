# be08-4th-DailyQuest-OneMinOneSec

![í¬ìŠ¤í„°](https://github.com/beyond-sw-camp/be08-4th-DQ-OMOS/blob/main/Images/%EB%A9%94%EC%9D%B8%EC%9D%B4%EB%AF%B8%EC%A7%80.png?raw=true)

<div align="center">
  <br><b>:dizzy:í•œí™”ì‹œìŠ¤í…œ BEYOND SWìº í”„ 4ì°¨ í”„ë¡œì íŠ¸:dizzy:</b></br></div>

  <br>
<br>
<div align="center">
<table>
  <tbody>
    <tr> 
      <td align="center"><a href="https://github.com/jongwon-kr"><img src="https://avatars.githubusercontent.com/u/76871947?v=4"width="140px;" height="140px" alt=""/><br /><b>ğŸ‘‘ê¹€ì¢…ì›</b></a><br /></td>
      <td align="center"><a href="https://github.com/tyeong1102"><img src="https://avatars.githubusercontent.com/u/97294927?s=96&v=4" width="140px;" height="140px" alt=""/><br /><b>ğŸ™ê¹€íƒœì˜</b></a><br /></td>
      <td align="center"><a href="https://github.com/tkckdnjs"><img src="https://avatars.githubusercontent.com/u/170069568?v=4" width="140px;" height="140px"  alt=""/><br /><b>ğŸ¶ì´ì€ì„œ</b></a><br /></td>
      <td align="center"><a href="https://github.com/eunhee78"><img src="https://avatars.githubusercontent.com/u/82626246?v=4" width="140px;" height="140px" alt=""/><br /><b>ğŸ‰ì¡°ì€í¬</b></a><br /></td>
      <td align="center"><a href="https://github.com/mmvne"><img src="https://avatars.githubusercontent.com/u/45449480?v=4" width="140px;" height="140px" alt=""/><br /><b>ğŸ§í™ì„ë¯¼</b></a><br /></td>
  </tbody>
</table>
</div>
<br>
<br>

<div align=center>

## ğŸ› ï¸ Tech Stack ğŸ› ï¸
  <h4>CI/CD</h4>
<div class="stack-container">
    <img src="https://img.shields.io/badge/Jenkins-D24939?style=for-the-badge&logo=Jenkins&logoColor=white">
    <img src="https://img.shields.io/badge/docker-002260?style=for-the-badge&logo=docker&logoColor=white">
    <img src="https://img.shields.io/badge/kubernetes-%231572B6?style=for-the-badge&logo=kubernetes&logoColor=white">
    <img src="https://img.shields.io/badge/ngrok-%233A0CA3?style=for-the-badge&logo=ngrok&logoColor=white">


<h4> Backend</h4>
<div class="stack-container">
    <img src="https://img.shields.io/badge/java-F7DF1E?style=for-the-badge&logo=java&logoColor=white">
    <img src="https://img.shields.io/badge/springboot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white">
    <img src="https://img.shields.io/badge/Amazon%20RDS-527FFF?style=for-the-badge&logo=Amazon%20RDS&logoColor=white">
	
</div>

<h4>Frontend</h4>
<div class="stack-container">
    <img src="https://img.shields.io/badge/html5-%23E34F26.svg?style=for-the-badge&logo=html5&logoColor=white">
    <img src="https://img.shields.io/badge/css3-%231572B6.svg?style=for-the-badge&logo=css3&logoColor=white">
    <img src="https://img.shields.io/badge/vuejs-%2335495e.svg?style=for-the-badge&logo=vuedotjs&logoColor=%234FC08D">
    <img src="https://img.shields.io/badge/bootstrap-%23563D7C?style=for-the-badge&logo=bootstrap&logoColor=white">
    <img src="https://img.shields.io/badge/PrimeVue-%23639a67?style=for-the-badge&logo=vue.js&logoColor=white">


</div>

<h4>VCS</h4>
<img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white"/>

<h4>í˜‘ì—… íˆ´</h4>
<img src="https://img.shields.io/badge/notion-000000?style=for-the-badge&logo=notion&logoColor=white"/>
<img src="https://img.shields.io/badge/googledocs-4285F4?style=for-the-badge&logo=googledocs&logoColor=white"/>
<img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white"/>
<img src="https://img.shields.io/badge/IntelliJ%20IDEA-000000.svg?style=for-the-badge&logo=intellij-idea&logoColor=white">
<img src="https://img.shields.io/badge/Visual%20Studio%20Code-007ACC?style=for-the-badge&logo=visual-studio-code&logoColor=white">




</div>

</div>
<br>
<br>
<br>

## ğŸ€ í”„ë¡œì íŠ¸ ì†Œê°œ

 OMOS : One Minute One Second

ğŸ€ ê´€ë¦¬ìì—ê²Œ í•™ìƒ ì •ë³´ë¥¼ ë³´ë‚´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
<br>

ğŸ€ ìº˜ë¦°ë”ë¥¼ í†µí•´ ì¼ì •ì„ í™•ì¸í•˜ê³  ì¡°ìœ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
<br> 
<br>
<br>

## ğŸ”† í”„ë¡œì íŠ¸ ëª©ì  ë° ê¸°ëŒ€íš¨ê³¼
êµìœ¡ ì¼ì • ë° íœ´ê°€ ì¼ì •ì„ ìº˜ë¦°ë”ë¥¼ í†µí•´ ì†ì‰½ê²Œ í™•ì¸í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ë§¤ë‹ˆì €ê°€ ìº˜ë¦°ë”ë¥¼ í†µí•´ ì¼ì •ì„ í•œëˆˆì— <br> íŒŒì•…í•˜ê³  êµìœ¡, ê°•ì˜, í”„ë¡œì íŠ¸
ì¼ì •ì„ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, ê°œì¸ íœ´ê°€ ê³„íš ë˜í•œ ê°„í¸í•œ í†µí•© ê´€ë¦¬ê°€ ê°€ëŠ¥í•˜ë„ë¡ ë„ì™€ì¤ë‹ˆë‹¤.

<br> 



<br>

## ğŸ“‘ ìš”êµ¬ì‚¬í•­ ëª…ì„¸ì„œ
<br>

[ìš”êµ¬ì‚¬í•­ ëª…ì„¸ì„œ](https://docs.google.com/spreadsheets/d/1UTnpUvR07tGe2TdFEmsZKeHrFMkpTfZzC-MN7yWY77c/edit?gid=0#gid=0)

![erd](https://github.com/beyond-sw-camp/be08-4th-DQ-OMOS/blob/main/Images/%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD%20%EB%AA%85%EC%84%B8%EC%84%9C.png?raw=true)

<br>

## ğŸ“‹ ERD
[ERD](https://www.erdcloud.com/d/T7nuCDkZTJACtXbog)

<br>

![erd](https://github.com/beyond-sw-camp/be08-4th-DQ-OMOS/blob/main/Images/erd.png?raw=true)

<br>


## ğŸ“„ API ëª…ì„¸ì„œ
<br>

[API ëª…ì„¸ì„œ](https://docs.google.com/spreadsheets/d/1kN0B6VXFFMemADbPnXZI4MWu9M5F2A280pIkb7VU2IQ/edit?gid=0#gid=0)

![api ëª…ì„¸ì„œ](https://github.com/beyond-sw-camp/be08-4th-DQ-OMOS/blob/main/Images/api%20%EB%AA%85%EC%84%B8%EC%84%9C.png?raw=true)


<br>
<br>

## ğŸ“º í™”ë©´ ì„¤ê³„ì„œ
[Figma ë³´ëŸ¬ê°€ê¸°](https://www.figma.com/board/CP2qZczh6IBRz0CkyhWt3l/Untitled?node-id=0-1&t=ALIywOoeckRvyGUO-1)

<br>
<br>

## ğŸ“‘ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

<br>

![ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](https://github.com/beyond-sw-camp/be08-4th-DQ-OMOS/blob/main/Images/%EC%8B%9C%EC%8A%A4%ED%85%9C%20%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98.png?raw=true)

## ğŸ“‘ CI/CD ì•„í‚¤í…ì²˜

<br>

![CI/CD](https://github.com/beyond-sw-camp/be08-4th-DQ-OMOS/blob/main/Images/cicd.png?raw=true)

<br>

## ğŸ©° CI/CD ëª…ì„¸ì„œ

<br>

[CI/CD ëª…ì„¸ì„œ](https://docs.google.com/spreadsheets/d/1hawxzb2t1vQTkrZNA07GJ4R340gKLJQtrtrhuxNI9Qk/edit?gid=0#gid=0)

![CI/CD](https://github.com/beyond-sw-camp/be08-4th-DQ-OMOS/blob/main/Images/cicd%20%EB%AA%85%EC%84%B8%EC%84%9C.png?raw=true)

<br>
<br>

## ğŸ“œ íŒŒì´í”„ë¼ì¸(Jenkinsfile)
<details>
<summary>auth-service-jenkinsfile</summary>

``` YML
pipeline {
    agent {
        kubernetes {
            yaml '''
            apiVersion: v1
            kind: Pod
            metadata:
              name: jenkins-agent-${env.BUILD_NUMBER}
            spec:
              containers:
              - name: gradle
                image: gradle:7.6.2-jdk17
                command:
                  - cat
                tty: true
              - name: docker
                image: docker:latest
                command:
                - cat
                tty: true
                volumeMounts:
                - mountPath: "/var/run/docker.sock"
                  name: docker-socket
              - name: kubectl
                image: gcr.io/cloud-builders/kubectl
                command:
                - cat
                tty: true
              volumes:
              - name: docker-socket
                hostPath:
                  path: "/var/run/docker.sock"
            '''
        }
    }

    environment {
        DOCKER_CREDENTIALS_ID = 'dockerhub_access'
        DOCKER_IMAGE_NAME = 'jjjwww8802/auth-service'
        DOCKERHUB_URL = 'https://index.docker.io/v1/'
        GITHUB_URL = 'git@github.com:beyond-sw-camp/be08-4th-DQ-OMOS.git'
        GITHUB_CREDENTIALS_ID = 'omos_access_ssh'
    }

    stages {
        stage('Checkout') {
            steps {
                git branch: 'main', credentialsId: "${GITHUB_CREDENTIALS_ID}", url: "${GITHUB_URL}"
            }
        }

        stage('Gradle Build') {
            steps {
                dir('Backend/auth-service') {
                    container('gradle') {
                        sh 'chmod +x ./gradlew'
                        sh './gradlew clean bootJar'
                    }
                }
            }
        }

        stage('Docker Image Build & Push') {
            steps {
                dir('Backend/auth-service') {
                    container('docker') {
                        script {
                            sh 'docker logout'
                            withCredentials([usernamePassword(credentialsId: "${DOCKER_CREDENTIALS_ID}", usernameVariable: 'DOCKER_USERNAME', passwordVariable: 'DOCKER_PASSWORD')]) {
                                sh 'echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin'
                            }
                            sh "docker build --no-cache -t ${DOCKER_IMAGE_NAME}:latest ."
                            sh "docker push ${DOCKER_IMAGE_NAME}:latest"
                            sh 'docker logout'
                        }
                    }
                }
            }
        }

        stage('Kubernetes Deployment') {
            steps {
                container('kubectl') {
                    script {
                        sh "kubectl set image deploy auth-deploy auth=${DOCKER_IMAGE_NAME}:latest -n default"
                        sh "kubectl rollout restart deploy auth-deploy -n default"
                    }
                }
            }
        }
    }

    post {
        success {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                ì œëª© : ${currentBuild.displayName}
                ê²°ê³¼ : ${currentBuild.result}
                ì‹¤í–‰ ì‹œê°„ : ${currentBuild.duration / 1000}s
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} ì„±ê³µ",
                webhookURL: "${DISCORD}"
            }
        }
        failure {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                ì œëª© : ${currentBuild.displayName}
                ê²°ê³¼ : ${currentBuild.result}
                ì‹¤í–‰ ì‹œê°„ : ${currentBuild.duration / 1000}s
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} ì‹¤íŒ¨",
                webhookURL: "${DISCORD}"
            }
        }
    }
}

```
</details>

<br>

<details>
<summary>calendar-service-jenkinsfile</summary>

``` YML
pipeline {
    agent {
        kubernetes {
            yaml '''
            apiVersion: v1
            kind: Pod
            metadata:
              name: jenkins-agent-${env.BUILD_NUMBER}
            spec:
              containers:
              - name: gradle
                image: gradle:7.6.2-jdk17
                command:
                  - cat
                tty: true
              - name: docker
                image: docker:latest
                command:
                - cat
                tty: true
                volumeMounts:
                - mountPath: "/var/run/docker.sock"
                  name: docker-socket
              - name: kubectl
                image: gcr.io/cloud-builders/kubectl
                command:
                - cat
                tty: true
              volumes:
              - name: docker-socket
                hostPath:
                  path: "/var/run/docker.sock"
            '''
        }
    }

    environment {
        DOCKER_CREDENTIALS_ID = 'dockerhub_access'
        DOCKER_IMAGE_NAME = 'jjjwww8802/calendar-service'
        DOCKERHUB_URL = 'https://index.docker.io/v1/'
        GITHUB_URL = 'git@github.com:beyond-sw-camp/be08-4th-DQ-OMOS.git'
        GITHUB_CREDENTIALS_ID = 'omos_access_ssh'
    }

    stages {
        stage('Checkout') {
            steps {
                git branch: 'main', credentialsId: "${GITHUB_CREDENTIALS_ID}", url: "${GITHUB_URL}"
            }
        }

        stage('Gradle Build') {
            steps {
                dir('Backend/calendar-service') {
                    container('gradle') {
                        sh 'chmod +x ./gradlew'
                        sh './gradlew clean bootJar'
                    }
                }
            }
        }

        stage('Docker Image Build & Push') {
            steps {
                dir('Backend/calendar-service') {
                    container('docker') {
                        script {
                            sh 'docker logout'
                            withCredentials([usernamePassword(credentialsId: "${DOCKER_CREDENTIALS_ID}", usernameVariable: 'DOCKER_USERNAME', passwordVariable: 'DOCKER_PASSWORD')]) {
                                sh 'echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin'
                            }
                            sh "docker build --no-cache -t ${DOCKER_IMAGE_NAME}:latest ."
                            sh "docker push ${DOCKER_IMAGE_NAME}:latest"
                            sh 'docker logout'
                        }
                    }
                }
            }
        }

        stage('Kubernetes Deployment') {
            steps {
                container('kubectl') {
                    script {
                        sh "kubectl set image deploy calendar-deploy calendar=${DOCKER_IMAGE_NAME}:latest -n default"
                        sh "kubectl rollout restart deploy calendar-deploy -n default"
                    }
                }
            }
        }
    }

    post {
        success {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                ì œëª© : ${currentBuild.displayName}
                ê²°ê³¼ : ${currentBuild.result}
                ì‹¤í–‰ ì‹œê°„ : ${currentBuild.duration / 1000}s
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} ì„±ê³µ",
                webhookURL: "${DISCORD}"
            }
        }
        failure {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                ì œëª© : ${currentBuild.displayName}
                ê²°ê³¼ : ${currentBuild.result}
                ì‹¤í–‰ ì‹œê°„ : ${currentBuild.duration / 1000}s
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} ì‹¤íŒ¨",
                webhookURL: "${DISCORD}"
            }
        }
    }
}

```
</details>

<br>

<details>
<summary>notice-service-jenkinsfile</summary>

``` YML
pipeline {
    agent {
        kubernetes {
            yaml '''
            apiVersion: v1
            kind: Pod
            metadata:
              name: jenkins-agent-${env.BUILD_NUMBER}
            spec:
              containers:
              - name: gradle
                image: gradle:7.6.2-jdk17
                command:
                  - cat
                tty: true
              - name: docker
                image: docker:latest
                command:
                - cat
                tty: true
                volumeMounts:
                - mountPath: "/var/run/docker.sock"
                  name: docker-socket
              - name: kubectl
                image: gcr.io/cloud-builders/kubectl
                command:
                - cat
                tty: true
              volumes:
              - name: docker-socket
                hostPath:
                  path: "/var/run/docker.sock"
            '''
        }
    }

    environment {
        DOCKER_CREDENTIALS_ID = 'dockerhub_access'
        DOCKER_IMAGE_NAME = 'jjjwww8802/notice-service'
        DOCKERHUB_URL = 'https://index.docker.io/v1/'
        GITHUB_URL = 'git@github.com:beyond-sw-camp/be08-4th-DQ-OMOS.git'
        GITHUB_CREDENTIALS_ID = 'omos_access_ssh'
    }

    stages {
        stage('Checkout') {
            steps {
                git branch: 'main', credentialsId: "${GITHUB_CREDENTIALS_ID}", url: "${GITHUB_URL}"
            }
        }

        stage('Gradle Build') {
            steps {
                dir('Backend/notice-service') {
                    container('gradle') {
                        sh 'chmod +x ./gradlew'
                        sh './gradlew clean bootJar'
                    }
                }
            }
        }

        stage('Docker Image Build & Push') {
            steps {
                dir('Backend/notice-service') {
                    container('docker') {
                        script {
                            sh 'docker logout'
                            withCredentials([usernamePassword(credentialsId: "${DOCKER_CREDENTIALS_ID}", usernameVariable: 'DOCKER_USERNAME', passwordVariable: 'DOCKER_PASSWORD')]) {
                                sh 'echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin'
                            }
                            sh "docker build --no-cache -t ${DOCKER_IMAGE_NAME}:latest ."
                            sh "docker push ${DOCKER_IMAGE_NAME}:latest"
                            sh 'docker logout'
                        }
                    }
                }
            }
        }

        stage('Kubernetes Deployment') {
            steps {
                container('kubectl') {
                    script {
                        sh "kubectl set image deploy notice-deploy notice=${DOCKER_IMAGE_NAME}:latest -n default"
                        sh "kubectl rollout restart deploy notice-deploy -n default"
                    }
                }
            }
        }
    }

    post {
        success {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                ì œëª© : ${currentBuild.displayName}
                ê²°ê³¼ : ${currentBuild.result}
                ì‹¤í–‰ ì‹œê°„ : ${currentBuild.duration / 1000}s
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} ì„±ê³µ",
                webhookURL: "${DISCORD}"
            }
        }
        failure {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                ì œëª© : ${currentBuild.displayName}
                ê²°ê³¼ : ${currentBuild.result}
                ì‹¤í–‰ ì‹œê°„ : ${currentBuild.duration / 1000}s
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} ì‹¤íŒ¨",
                webhookURL: "${DISCORD}"
            }
        }
    }
}

```
</details>

<br>

<details>
<summary>notification-service-jenkinsfile</summary>

``` YML
pipeline {
    agent {
        kubernetes {
            yaml '''
            apiVersion: v1
            kind: Pod
            metadata:
              name: jenkins-agent-${env.BUILD_NUMBER}
            spec:
              containers:
              - name: gradle
                image: gradle:7.6.2-jdk17
                command:
                  - cat
                tty: true
              - name: docker
                image: docker:latest
                command:
                - cat
                tty: true
                volumeMounts:
                - mountPath: "/var/run/docker.sock"
                  name: docker-socket
              - name: kubectl
                image: gcr.io/cloud-builders/kubectl
                command:
                - cat
                tty: true
              volumes:
              - name: docker-socket
                hostPath:
                  path: "/var/run/docker.sock"
            '''
        }
    }

    environment {
        DOCKER_CREDENTIALS_ID = 'dockerhub_access'
        DOCKER_IMAGE_NAME = 'jjjwww8802/notification-service'
        DOCKERHUB_URL = 'https://index.docker.io/v1/'
        GITHUB_URL = 'git@github.com:beyond-sw-camp/be08-4th-DQ-OMOS.git'
        GITHUB_CREDENTIALS_ID = 'omos_access_ssh'
    }

    stages {
        stage('Checkout') {
            steps {
                git branch: 'main', credentialsId: "${GITHUB_CREDENTIALS_ID}", url: "${GITHUB_URL}"
            }
        }

        stage('Gradle Build') {
            steps {
                dir('Backend/notification-service') {
                    container('gradle') {
                        sh 'chmod +x ./gradlew'
                        sh './gradlew clean bootJar'
                    }
                }
            }
        }

        stage('Docker Image Build & Push') {
            steps {
                dir('Backend/notification-service') {
                    container('docker') {
                        script {
                            sh 'docker logout'
                            withCredentials([usernamePassword(credentialsId: "${DOCKER_CREDENTIALS_ID}", usernameVariable: 'DOCKER_USERNAME', passwordVariable: 'DOCKER_PASSWORD')]) {
                                sh 'echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin'
                            }
                            sh "docker build --no-cache -t ${DOCKER_IMAGE_NAME}:latest ."
                            sh "docker push ${DOCKER_IMAGE_NAME}:latest"
                            sh 'docker logout'
                        }
                    }
                }
            }
        }

        stage('Kubernetes Deployment') {
            steps {
                container('kubectl') {
                    script {
                        sh "kubectl set image deploy notification-deploy notification=${DOCKER_IMAGE_NAME}:latest -n default"
                        sh "kubectl rollout restart deploy notification-deploy -n default"
                    }
                }
            }
        }
    }

    post {
        success {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                ì œëª© : ${currentBuild.displayName}
                ê²°ê³¼ : ${currentBuild.result}
                ì‹¤í–‰ ì‹œê°„ : ${currentBuild.duration / 1000}s
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} ì„±ê³µ",
                webhookURL: "${DISCORD}"
            }
        }
        failure {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                ì œëª© : ${currentBuild.displayName}
                ê²°ê³¼ : ${currentBuild.result}
                ì‹¤í–‰ ì‹œê°„ : ${currentBuild.duration / 1000}s
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} ì‹¤íŒ¨",
                webhookURL: "${DISCORD}"
            }
        }
    }
}


```
</details>

<br>

<details>
<summary>student-service-jenkinsfile</summary>

``` YML
pipeline {
    agent {
        kubernetes {
            yaml '''
            apiVersion: v1
            kind: Pod
            metadata:
              name: jenkins-agent-${env.BUILD_NUMBER}
            spec:
              containers:
              - name: gradle
                image: gradle:7.6.2-jdk17
                command:
                  - cat
                tty: true
              - name: docker
                image: docker:latest
                command:
                - cat
                tty: true
                volumeMounts:
                - mountPath: "/var/run/docker.sock"
                  name: docker-socket
              - name: kubectl
                image: gcr.io/cloud-builders/kubectl
                command:
                - cat
                tty: true
              volumes:
              - name: docker-socket
                hostPath:
                  path: "/var/run/docker.sock"
            '''
        }
    }

    environment {
        DOCKER_CREDENTIALS_ID = 'dockerhub_access'
        DOCKER_IMAGE_NAME = 'jjjwww8802/student-service'
        DOCKERHUB_URL = 'https://index.docker.io/v1/'
        GITHUB_URL = 'git@github.com:beyond-sw-camp/be08-4th-DQ-OMOS.git'
        GITHUB_CREDENTIALS_ID = 'omos_access_ssh'
    }

    stages {
        stage('Checkout') {
            steps {
                git branch: 'main', credentialsId: "${GITHUB_CREDENTIALS_ID}", url: "${GITHUB_URL}"
            }
        }

        stage('Gradle Build') {
            steps {
                dir('Backend/student-service') {
                    container('gradle') {
                        sh 'chmod +x ./gradlew'
                        sh './gradlew clean bootJar'
                    }
                }
            }
        }

        stage('Docker Image Build & Push') {
            steps {
                dir('Backend/student-service') {
                    container('docker') {
                        script {
                            sh 'docker logout'
                            withCredentials([usernamePassword(credentialsId: "${DOCKER_CREDENTIALS_ID}", usernameVariable: 'DOCKER_USERNAME', passwordVariable: 'DOCKER_PASSWORD')]) {
                                sh 'echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin'
                            }
                            sh "docker build --no-cache -t ${DOCKER_IMAGE_NAME}:latest ."
                            sh "docker push ${DOCKER_IMAGE_NAME}:latest"
                            sh 'docker logout'
                        }
                    }
                }
            }
        }

        stage('Kubernetes Deployment') {
            steps {
                container('kubectl') {
                    script {
                        sh "kubectl set image deploy student-deploy student=${DOCKER_IMAGE_NAME}:latest -n default"
                        sh "kubectl rollout restart deploy student-deploy -n default"
                    }
                }
            }
        }
    }

    post {
        success {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                ì œëª© : ${currentBuild.displayName}
                ê²°ê³¼ : ${currentBuild.result}
                ì‹¤í–‰ ì‹œê°„ : ${currentBuild.duration / 1000}s
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} ì„±ê³µ",
                webhookURL: "${DISCORD}"
            }
        }
        failure {
            withCredentials([string(credentialsId: 'discord-webhook', variable: 'DISCORD')]) {
                discordSend description: """
                ì œëª© : ${currentBuild.displayName}
                ê²°ê³¼ : ${currentBuild.result}
                ì‹¤í–‰ ì‹œê°„ : ${currentBuild.duration / 1000}s
                """,
                result: currentBuild.currentResult,
                title: "${env.JOB_NAME} : ${currentBuild.displayName} ì‹¤íŒ¨",
                webhookURL: "${DISCORD}"
            }
        }
    }
}

```
</details>

<br>
<br>

## â–¶ï¸ CICD í…ŒìŠ¤íŠ¸(Jenkinsfile)
[![IMAGE ALT TEXT HERE](https://img.youtube.com/vi/kdVEqg6ewk0/0.jpg)](https://www.youtube.com/watch?v=kdVEqg6ewk0)
<br>

## ğŸ“… WBS

<br>

[WBS](https://docs.google.com/spreadsheets/d/1BI3uCB31D9dol-k-YqnDGOJ90PBCP7Zki6-JhUEhBj8/edit?gid=0#gid=0)

![wbs](https://github.com/beyond-sw-camp/be08-4th-DQ-OMOS/blob/main/Images/wbs.png?raw=true)



<br>


## ğŸ» í•œì¤„ íšŒê³ ë¡
|&nbsp;&nbsp;&nbsp;&nbsp;íŒ€&nbsp;ì›&nbsp;&nbsp;&nbsp;&nbsp;|íšŒê³ |
|:----:|----|
|ğŸ‘‘ê¹€ì¢…ì›|<br>Devops í”„ë¡œì íŠ¸ì—ì„œ Spring Bootê³¼ Vuejs ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ CI/CD íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ë©°, Jenkinsì™€ Kubernetes ì„¤ì • ê³¼ì •ì—ì„œ Helmì„ í™œìš©í•´ íš¨ìœ¨ì ìœ¼ë¡œ í™˜ê²½ì„ êµ¬ì¶•í•´ë³´ê³ , Ngrokì„ ì´ìš©í•´ ê¹ƒí—ˆë¸Œì™€ ì›¹í›…ì„ ì—°ê²°í•´ ìë™í™”ë¥¼ í•˜ì˜€ìŠµë‹ˆë‹¤. Gradleì„ í†µí•œ ë¹Œë“œ í›„ Docker ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê³  Docker Hubì— í‘¸ì‹œí•˜ì—¬ ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ ë°°í¬ ì‘ì—…ì„ í•´ë³´ë©° ì˜ ëª°ëë˜ CI/CDë¥¼ ì´í•´í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. í”„ë¡œì íŠ¸ ì´ˆê¸°ì— ê¸°ì¡´ì˜ ê°œë°œë°©ì‹ê³¼ ë‹¤ë¥´ê²Œ MSA ë°©ì‹ìœ¼ë¡œ ê°œë°œí•´ë³´ê³ ì ì œì•ˆì„ í–ˆê³  ë§¤ì¼ ë‚¨ì•„ì„œ ê³µë¶€í•˜ë©° ì—´ì‹¬íˆ í•´ì¤€ íŒ€ì›ë“¤ì—ê²Œ ê³ ë§™ìŠµë‹ˆë‹¤!!<br>&nbsp;|
|ğŸ™ê¹€íƒœì˜|<br>ì²˜ìŒìœ¼ë¡œ í•´ë³´ëŠ” CI/CD í”„ë¡œì íŠ¸ë¼ì„œ ë„ì»¤, ì¿ ë²„ë„¤í‹°ìŠ¤, ì  í‚¨ìŠ¤ì˜ ë™ì‘ ì›ë¦¬ë¥¼ ì•Œ ìˆ˜ ìˆëŠ” ì†Œì¤‘í•œ ê¸°íšŒì˜€ë˜ ê²ƒ ê°™ìŠµë‹ˆë‹¤.<br>&nbsp;|
|ğŸ¶ì´ì€ì„œ|<br>ì´ë²ˆ í”„ë¡œì íŠ¸ë¥¼ í”„ë¡ íŠ¸ì—”ë“œë¶€í„° ë°±ì—”ë“œ ê·¸ë¦¬ê³  CI/CD íŒŒì´í”„ë¼ì¸ì„ ë§Œë“¤ì–´ì„œ ë°°í¬ê¹Œì§€ ê²½í—˜ í•  ìˆ˜ ìˆì–´ì„œ ì¢‹ì•˜ìŠµë‹ˆë‹¤. ë°°í¬í•˜ëŠ” ê³¼ì •ì´ ì–´ë ¤ì›Œ í•´ê²°í•˜ì§€ ëª»í•œ ë¶€ë¶„ë“¤ì„ íŒ€ì›ë“¤ ë•ë¶„ì— ë°°í¬ê¹Œì§€ ë§ˆë¬´ë¦¬ í•  ìˆ˜ ìˆì—ˆë˜ ê²ƒ ê°™ìŠµë‹ˆë‹¤!!<br>&nbsp;|
|ğŸ§ì¡°ì€í¬|<br>ì´ë²ˆ í”„ë¡œì íŠ¸ëŠ” í”„ë¡ íŠ¸ì—”ë“œë¶€í„° ë°°í¬ê¹Œì§€ CI/CD íŒŒì´í”„ë¼ì¸ì„ ì§ì ‘ ê²½í—˜í•  ìˆ˜ ìˆì—ˆë˜ ì¢‹ì€ ê¸°íšŒì˜€ìŠµë‹ˆë‹¤. íŠ¹íˆ ë°°í¬ ê³¼ì •ì—ì„œ ë…¸íŠ¸ë¶ ì„±ëŠ¥ì´ ë‚®ì•„ ë¹Œë“œì™€ í…ŒìŠ¤íŠ¸ ì†ë„ê°€ ëŠë ¤ì§€ëŠ” ë¬¸ì œê°€ ë°œìƒí•˜ì˜€ê³ , íš¨ìœ¨ì ì¸ ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ì™€ í™˜ê²½ ìµœì í™”ì˜ ì¤‘ìš”ì„±ì„ ê¹¨ë‹«ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.<br>&nbsp;|
|ğŸ§í™ì„ë¯¼|<br>ì´ë²ˆ ë°ë¸Œì˜µìŠ¤ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ ê¸°ì¡´ ëª¨ë†€ë¦¬ë”• ë°©ì‹ì´ ì•„ë‹Œ msa ë°©ì‹ìœ¼ë¡œ ì§„í–‰ì„ í•´ë³´ì•˜ëŠ”ë° ì¤‘ê°„ì¤‘ê°„ ì„¤ê³„ë¥¼ ë°”ê¾¸ì§€ ì•Šìœ¼ë©´ í•´ê²°í•˜ì§€ ëª»í•˜ëŠ” ë¬¸ì œë“¤ì„ ë§ˆì£¼í•˜ë©´ì„œ ì„¤ê³„ê°€ ì •ë§ ì¤‘ìš”í•˜ê³  ì‹ ì¤‘í•˜ê²Œ ìƒê°í•´ì•¼ í•˜ëŠ” ê±¸ ë‹¤ì‹œ í•œë²ˆ ëŠê¼ˆìŠµë‹ˆë‹¤. ë°ë¸Œì˜µìŠ¤ë„ ê²°ì½” ë§Œë§Œì¹˜ ì•Šì•˜ê³  ì™œ ë°ë¸Œì˜µìŠ¤ ê°œë°œìê°€ ë”°ë¡œ ìˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆëŠ” ì‹œê°„ì´ì—ˆìŠµë‹ˆë‹¤.<br>&nbsp;|

<br>
